<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="511px" preserveAspectRatio="none" style="width:439px;height:511px;" version="1.1" viewBox="0 0 439 511" width="439px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ey5heq38eras" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--entity API--><rect fill="#FEFECE" filter="url(#f1ey5heq38eras)" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="182.5" y="8"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="177.5" y="13"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="177.5" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="21" x="192.5" y="30.9951">API</text><!--entity Subscriber--><rect fill="#FEFECE" filter="url(#f1ey5heq38eras)" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="33" y="8"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="28" y="13"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="28" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="43" y="30.9951">Subscriber</text><!--entity ServiceLayer--><rect fill="#FEFECE" filter="url(#f1ey5heq38eras)" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="150" y="123"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="145" y="128"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="145" y="149.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="160" y="145.9951">ServiceLayer</text><!--entity EntityActor--><rect fill="#FEFECE" filter="url(#f1ey5heq38eras)" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="170" y="238"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="165" y="243"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="165" y="264.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="180" y="260.9951">EntityActor</text><!--entity Entity--><rect fill="#FEFECE" filter="url(#f1ey5heq38eras)" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="311" y="351"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="306" y="356"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="306" y="377.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="321" y="373.9951">Entity</text><!--entity Publisher--><rect fill="#FEFECE" filter="url(#f1ey5heq38eras)" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="59" y="351"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="54" y="356"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="54" y="377.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="69" y="373.9951">Publisher</text><!--entity Kafka--><rect fill="#FEFECE" filter="url(#f1ey5heq38eras)" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="16.5" y="464"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="11.5" y="469"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="11.5" y="490.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="26.5" y="486.9951">Kafka</text><!--entity Cassandra--><rect fill="#FEFECE" filter="url(#f1ey5heq38eras)" height="36.2969" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="178.5" y="351"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="173.5" y="356"/><rect fill="#FEFECE" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="173.5" y="377.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="188.5" y="373.9951">Cassandra</text><path d="M291,121 L291,137 L256.0977,141 L291,145 L291,161.2656 A0,0 0 0 0 291,161.2656 L391,161.2656 A0,0 0 0 0 391,161.2656 L391,131 L381,121 L291,121 A0,0 0 0 0 291,121 " fill="#FBFB77" filter="url(#f1ey5heq38eras)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M381,121 L381,131 L391,131 L381,121 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="297" y="138.0669">coordination</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="297" y="153.1997">autorization</text><path d="M299.5,243.5 L299.5,252 L264.168,256 L299.5,260 L299.5,268.6328 A0,0 0 0 0 299.5,268.6328 L410.5,268.6328 A0,0 0 0 0 410.5,268.6328 L410.5,253.5 L400.5,243.5 L299.5,243.5 A0,0 0 0 0 299.5,243.5 " fill="#FBFB77" filter="url(#f1ey5heq38eras)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M400.5,243.5 L400.5,253.5 L410.5,253.5 L400.5,243.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="305.5" y="260.5669">active/passive</text><path d="M252.5,469.5 L252.5,494.6328 A0,0 0 0 0 252.5,494.6328 L427.5,494.6328 A0,0 0 0 0 427.5,494.6328 L427.5,479.5 L417.5,469.5 L344,469.5 L340,387.1554 L336,469.5 L252.5,469.5 A0,0 0 0 0 252.5,469.5 " fill="#FBFB77" filter="url(#f1ey5heq38eras)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M417.5,469.5 L417.5,479.5 L427.5,479.5 L417.5,469.5 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="258.5" y="486.5669">state and business logic</text><!--link Subscriber to Kafka--><path d="M58.9925,44.0336 C37.1149,64.9349 6,101.5889 6,141 C6,141 6,141 6,369 C6,401.7445 20.8141,437.0497 32.1818,459.3213 " fill="none" id="Subscriber-Kafka" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="34.5487,463.8704,33.943,454.0402,32.2409,459.4349,26.8462,457.7327,34.5487,463.8704" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="7" y="253.0669">subscribe topic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="8.5" y="268.1997">receive events</text><!--link API to ServiceLayer--><path d="M203,44.2221 C203,64.1574 203,96.1584 203,117.8552 " fill="none" id="API-ServiceLayer" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="203,122.8632,207,113.8632,203,117.8632,199,113.8632,203,122.8632" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="204" y="87.0669">commands</text><!--link Subscriber to ServiceLayer--><path d="M99.4897,44.2221 C121.2616,64.578 156.4889,97.514 179.6989,119.2144 " fill="none" id="Subscriber-ServiceLayer" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="183.6015,122.8632,179.7589,113.7949,179.9491,119.4485,174.2955,119.6387,183.6015,122.8632" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="150" y="87.0669">events</text><!--link ServiceLayer to EntityActor--><path d="M205.2183,159.2221 C207.6452,179.1574 211.541,211.1584 214.1824,232.8552 " fill="none" id="ServiceLayer-EntityActor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="214.792,237.8632,217.675,228.4457,214.1877,232.8998,209.7336,229.4126,214.792,237.8632" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="211" y="204.0669">commands</text><!--link EntityActor to Entity--><path d="M264.2363,269.456 C283.1672,276.9335 303.8103,288.0402 318,304 C328.2728,315.5543 333.7839,332.0976 336.7212,345.6026 " fill="none" id="EntityActor-Entity" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="337.7599,350.8014,339.9188,341.1921,336.7802,345.8983,332.0739,342.7597,337.7599,350.8014" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EntityActor to Publisher--><path d="M198.3626,274.1554 C177.8995,294.0892 145.0594,326.0801 123.2593,347.3164 " fill="none" id="EntityActor-Publisher" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="119.5912,350.8897,128.8291,347.4748,123.1727,347.4008,123.2468,341.7444,119.5912,350.8897" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Publisher to Kafka--><path d="M92.0026,387.1554 C82.2872,406.7598 66.7925,438.0258 56.272,459.2547 " fill="none" id="Publisher-Kafka" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="53.975,463.8897,61.5555,457.6019,56.1953,459.4097,54.3875,454.0495,53.975,463.8897" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="78" y="430.0669">publish events</text><!--link EntityActor to Cassandra--><path d="M216.6512,274.2417 C216.5552,287.287 216.7358,305.2502 218,321 C218.646,329.0482 219.79,337.8006 220.9683,345.6008 " fill="none" id="EntityActor-Cassandra" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="221.7838,350.8285,224.3487,341.3195,221.0131,345.8883,216.4443,342.5527,221.7838,350.8285" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="219" y="317.0669">event sourcing</text><!--
@startuml
[API]
[Subscriber]
[ServiceLayer]
[EntityActor]
[Entity]
[Publisher]
[Kafka]
[Cassandra]

[Subscriber] ..> [Kafka]: subscribe topic\nreceive events

[API] ..> [ServiceLayer]: commands

[Subscriber] ..> [ServiceLayer]: events
note right: coordination\nautorization 

[ServiceLayer] ..> [EntityActor]: commands
note right: active/passive 

[EntityActor] ..> [Entity]
note bottom: state and business logic

[EntityActor] ..> [Publisher]

[Publisher] ..> [Kafka]: publish events

[EntityActor] ..> [Cassandra]: event sourcing
@enduml

PlantUML version 1.2018.11(Sat Sep 22 18:43:53 CEST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1248-b22
Operating System: Linux
OS Version: 4.15.0-38-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>